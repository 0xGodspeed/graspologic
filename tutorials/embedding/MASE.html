

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Multiple Adjacency Spectral Embedding (MASE) &mdash; graspologic 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Latent Position Two-Graph Testing" href="../inference/latent_position_test.html" />
    <link rel="prev" title="Omnibus Embedding for Multiple Graphs" href="Omnibus.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> graspologic
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../models/models.html">Random Graph Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/models.html#This-tutorial-will-introduce-the-following-random-graph-models:">This tutorial will introduce the following random graph models:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Load-some-data-from-graspologic">Load some data from <em>graspologic</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Preliminaries">Preliminaries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/models.html#For-each-graph-model-we-will-show:">For each graph model we will show:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Erdos-Reyni-(ER)">Erdos-Reyni (ER)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Degree-corrected-Erdos-Reyni-(DCER)">Degree-corrected Erdos-Reyni (DCER)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Stochastic-block-model-(SBM)">Stochastic block model (SBM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Degree-corrected-stochastic-block-model-(DCSBM)">Degree-corrected stochastic block model (DCSBM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Random-dot-product-graph-(RDPG)">Random dot product graph (RDPG)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/models.html#Create-a-figure-combining-all-of-the-models">Create a figure combining all of the models</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simulations/erdos_renyi.html">Erdos-Renyi (ER) Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/erdos_renyi.html#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/erdos_renyi.html#Weighted-ER-Graphs">Weighted ER Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/erdos_renyi.html#Visualize-the-graph-using-heatmap">Visualize the graph using heatmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations/sbm.html">Stochastic Block Model (SBM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/sbm.html#Visualize-the-graph-using-heatmap">Visualize the graph using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/sbm.html#Weighted-SBM-Graphs">Weighted SBM Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/sbm.html#id1">Visualize the graph using heatmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations/mmsbm.html">Mixed Membership Stochastic Blockmodel (MMSBM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/mmsbm.html#Visualize-the-graph-using-heatmap">Visualize the graph using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/mmsbm.html#Generating-various-types-of-graphs">Generating various types of graphs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../simulations/mmsbm.html#Generating-Erdos-Renyi-(ER)-graphs">Generating Erdos-Renyi (ER) graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulations/mmsbm.html#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulations/mmsbm.html#Differences-with-Stochastic-Block-Model-(SBM)-graphs">Differences with Stochastic Block Model (SBM) graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../simulations/mmsbm.html#Plot-SBM-and-MMSBM-graphs-using-heatmap">Plot SBM and MMSBM graphs using heatmap</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations/rdpg.html">Random Dot Product Graph (RDPG) Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/rdpg.html#Visualize-the-adjacency-matrix">Visualize the adjacency matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/rdpg.html#Stochastic-block-model-as-RDPG">Stochastic block model as RDPG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../simulations/rdpg.html#Results-from-SBM-simulation-using-same-formulation-shows-similar-structure">Results from SBM simulation using same formulation shows similar structure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations/corr.html">Correlated Graph Pairs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/corr.html#ER-correlation-graph-pair">ER correlation graph pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/corr.html#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/corr.html#SBM-correlated-graph-pair">SBM correlated graph pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/corr.html#id1">Visualize the graphs using heatmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulations/rdpg_corr.html">Correlated Random Dot Product Graph (RDPG) Graph Pair</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/rdpg_corr.html#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/rdpg_corr.html#Compare-it-to-the-correlated-SBM-graph-pair">Compare it to the correlated SBM graph pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/rdpg_corr.html#Varying-the-correlation">Varying the correlation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../clustering/autogmm.html">Automatic Gaussian Mixture Modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../clustering/autogmm.html#Using-AutoGMM-on-Synthetic-Data">Using AutoGMM on Synthetic Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../clustering/kclust.html">K-Means Clustering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../clustering/kclust.html#Using-K-Means-on-Synthetic-Data">Using K Means on Synthetic Data</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="AdjacencySpectralEmbed.html">Adjacency Spectral Embed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="AdjacencySpectralEmbed.html#Data-Generation">Data Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="AdjacencySpectralEmbed.html#Embedding:-Undirected-Case">Embedding: Undirected Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="AdjacencySpectralEmbed.html#Embedding:-Directed-Case">Embedding: Directed Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="AdjacencySpectralEmbed.html#Dimension-specification">Dimension specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="AdjacencySpectralEmbed.html#Clustering-in-the-embedded-space">Clustering in the embedded space</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OutOfSampleEmbed.html">Out-of-Sample (OOS) Embedding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OutOfSampleEmbed.html#Undirected-out-of-sample-prediction">Undirected out-of-sample prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OutOfSampleEmbed.html#Embedding">Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="OutOfSampleEmbed.html#Passing-in-multiple-out-of-sample-vertices">Passing in multiple out-of-sample vertices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OutOfSampleEmbed.html#Directed-out-of-sample-prediction">Directed out-of-sample prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OutOfSampleEmbed.html#Plotting-directed-latent-predictions">Plotting directed latent predictions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OutOfSampleEmbed.html#Weighted-out-of-sample-prediction">Weighted out-of-sample prediction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Omnibus.html">Omnibus Embedding for Multiple Graphs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Omnibus.html#Simulate-two-different-graphs-using-stochastic-block-models-(SBM)">Simulate two different graphs using stochastic block models (SBM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Omnibus.html#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="Omnibus.html#Embed-the-two-graphs-using-omnibus-embedding">Embed the two graphs using omnibus embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="Omnibus.html#Visualize-the-latent-positions">Visualize the latent positions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multiple Adjacency Spectral Embedding (MASE)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Replicating-Omnibus-Embedding-Tutorial">Replicating Omnibus Embedding Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Simulate-two-different-graphs-using-stochastic-block-models-(SBM)">Simulate two different graphs using stochastic block models (SBM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualize-the-graphs-using-heatmap">Visualize the graphs using heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Embed-the-two-graphs-using-MASE">Embed the two graphs using MASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualize-Common-Latent-Positions">Visualize Common Latent Positions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Recover-Original-Communities">Recover Original Communities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sampling-More-Graphs">Sampling More Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualizing-Common-Latent-Subspace">Visualizing Common Latent Subspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualize-Score-Matrices">Visualize Score Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Recover-Original-SBM-Membership">Recover Original SBM Membership</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inference/latent_position_test.html">Latent Position Two-Graph Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_position_test.html#Generate-a-stochastic-block-model-graph-to-model-as-a-random-dot-product-graph">Generate a stochastic block model graph to model as a random dot product graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_position_test.html#Sample-new-RDPGs-from-this-latent-position">Sample new RDPGs from this latent position</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_position_test.html#Latent-position-test-where-null-is-true">Latent position test where null is true</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_position_test.html#Matched-test-where-the-null-is-false">Matched test where the null is false</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../inference/latent_distribution_test.html">Latent Distribution Two-Graph Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_distribution_test.html#Generate-a-stochastic-block-model-graph">Generate a stochastic block model graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_distribution_test.html#Latent-distribution-test-where-null-is-true">Latent distribution test where null is true</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_distribution_test.html#Plots-of-Null-Distribution-for-Dcorr-and-MGC">Plots of Null Distribution for Dcorr and MGC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_distribution_test.html#Latent-distribution-test-where-null-is-false">Latent distribution test where null is false</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference/latent_distribution_test.html#Plot-of-Null-Distribution">Plot of Null Distribution</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plotting/heatmaps.html">Heatmap: Visualizing a Graph</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plotting/heatmaps.html#Plotting-graphs-using-heatmap">Plotting graphs using heatmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plotting/heatmaps.html#Simulate-graphs-using-weighted-stochastic-block-models">Simulate graphs using weighted stochastic block models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/heatmaps.html#Plot-the-simulated-weighted-SBMs">Plot the simulated weighted SBMs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plotting/heatmaps.html#You-can-also-change-color-maps">You can also change color maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/heatmaps.html#Data-transformations">Data transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plotting/heatmaps.html#Without-transform">Without transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plotting/heatmaps.html#With-log-transform">With log transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plotting/heatmaps.html#With-pass-to-ranks">With pass to ranks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/gridplot.html">Gridplot: Visualize Multiple Graphs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plotting/gridplot.html#Overlaying-two-sparse-graphs-using-gridplot">Overlaying two sparse graphs using gridplot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plotting/gridplot.html#Simulate-more-graphs-using-weighted-stochastic-block-models">Simulate more graphs using weighted stochastic block models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/gridplot.html#Visualizing-both-graphs">Visualizing both graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/pairplot.html">Pairplot: Visualizing High Dimensional Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot.html#Simulate-a-binary-graph-using-stochastic-block-model">Simulate a binary graph using stochastic block model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot.html#Embed-using-adjacency-spectral-embedding-to-obtain-lower-dimensional-representation-of-the-graph">Embed using adjacency spectral embedding to obtain lower dimensional representation of the graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot.html#Use-pairplot-to-plot-the-embedded-data">Use pairplot to plot the embedded data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/pairplot_with_gmm.html">Pairplot with GMM: Visualizing High Dimensional Data and Clustering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot_with_gmm.html#Simulate-a-binary-graph-using-stochastic-block-model">Simulate a binary graph using stochastic block model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot_with_gmm.html#Embed-using-adjacency-spectral-embedding-to-obtain-lower-dimensional-representation-of-the-graph">Embed using adjacency spectral embedding to obtain lower dimensional representation of the graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/pairplot_with_gmm.html#Use-pairplot_with_gmm-to-plot-the-embedded-data-with-ellipses">Use pairplot_with_gmm to plot the embedded data with ellipses</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../matching/faq.html">Introduction to Graph Matching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../matching/faq.html#Visualize-the-graphs-using-heat-mapping">Visualize the graphs using heat mapping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../matching/sgm.html">Seeded Graph Matching (SGM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../matching/sgm.html#SGM-on-Correlated-Graph-Pairs">SGM on Correlated Graph Pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matching/sgm.html#Shuffling-graph-2">Shuffling graph 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matching/sgm.html#Unshuffling-graph-2-without-seeds">Unshuffling graph 2 without seeds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matching/sgm.html#Unshuffling-graph-2-with-10-seeds">Unshuffling graph 2 with 10 seeds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../matching/padded_gm.html">Padded Graph Matching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../matching/padded_gm.html#SBM-correlated-graph-pairs">SBM correlated graph pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matching/padded_gm.html#Naive-vs-Adopted-Padding">Naive vs Adopted Padding</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../subgraph/subgraph.html">Signal Subgraph Estimators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../subgraph/subgraph.html#This-tutorial-will-introduce-the-following-signal-subgraph-estimators:">This tutorial will introduce the following signal-subgraph estimators:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../subgraph/subgraph.html#Preliminaries">Preliminaries</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vertex_nomination/SpectralVertexNomination.html">Spectral Vertex Nomination</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../vertex_nomination/SpectralVertexNomination.html#What-is-Spectral-Vertex-Nomination?">What is Spectral Vertex Nomination?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nominate/vertex_nomination_via_SGM.html">Nomination via SGM</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aligning/aligning.html">Aligning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../aligning/aligning.html#Simple-rotation-example">Simple rotation example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../aligning/aligning.html#SignFlips">SignFlips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aligning/aligning.html#OrthogonalProcrustes">OrthogonalProcrustes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aligning/aligning.html#SeedlessProcrustes">SeedlessProcrustes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aligning/aligning.html#Comparison-between-SignFlips,-OrthogonalProcrustes,-SeedlessProcrustes">Comparison between SignFlips, OrthogonalProcrustes, SeedlessProcrustes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../aligning/aligning.html#Shuffled-Example">Shuffled Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aligning/aligning.html#Unmatched-example">Unmatched example</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../connectomics/mcc.html">Methods for Multiscale Comparative Connectomics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../connectomics/mcc.html#Load-the-Duke-mouse-brain-dataset">Load the Duke mouse brain dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectomics/mcc.html#Identifying-Signal-Edges">Identifying Signal Edges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectomics/mcc.html#Identifying-Signal-Vertices">Identifying Signal Vertices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectomics/mcc.html#Whole-brain-Comparisons">Whole-brain Comparisons</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">graspologic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Multiple Adjacency Spectral Embedding (MASE)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/embedding/MASE.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Multiple-Adjacency-Spectral-Embedding-(MASE)">
<h1>Multiple Adjacency Spectral Embedding (MASE)<a class="headerlink" href="#Multiple-Adjacency-Spectral-Embedding-(MASE)" title="Permalink to this headline">¶</a></h1>
<p>Multiple Adjacency Spectral Embedding (MASE) is an extension of Adjacency Spectral Embedding (see ASE <a class="reference external" href="https://graspy.neurodata.io/tutorials/embedding/adjacencyspectralembed">tutorial</a>) for an arbitrary number of graphs. Once graphs are embedded, the low-dimensional Euclidean representation can be used to visualize the latent positions of vertices, perform inference, etc.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="Replicating-Omnibus-Embedding-Tutorial">
<h2>Replicating Omnibus Embedding Tutorial<a class="headerlink" href="#Replicating-Omnibus-Embedding-Tutorial" title="Permalink to this headline">¶</a></h2>
<p>In order to demonstrate how to use the <code class="docutils literal notranslate"><span class="pre">MultipleASE</span></code> class, we will use a simple example: two 2-block stochastic block models (SBMs) with different block probabilities. Indeed, we will use the same models as in the omnibus <a class="reference external" href="https://graspy.neurodata.io/tutorials/embedding/omnibus">tutorial</a> to facilitate direct comparison.</p>
</div>
<div class="section" id="Simulate-two-different-graphs-using-stochastic-block-models-(SBM)">
<h2>Simulate two different graphs using stochastic block models (SBM)<a class="headerlink" href="#Simulate-two-different-graphs-using-stochastic-block-models-(SBM)" title="Permalink to this headline">¶</a></h2>
<p>We sample two 2-block SBMs (undirected, no self-loops) with 50 vertices, each block containing 25 vertices (<span class="math notranslate nohighlight">\(n = [25, 25]\)</span>), and with the following block connectivity matrices:</p>
<div class="math notranslate nohighlight">
\begin{align*}
B_1 =
\begin{bmatrix}0.3 &amp; 0.1\\
0.1 &amp; 0.7
\end{bmatrix},~
B_2 = \begin{bmatrix}0.3 &amp; 0.1\\
0.1 &amp; 0.3
\end{bmatrix}
\end{align*}</div><p>The only difference between the two is the within-block probability for the second block. We sample <span class="math notranslate nohighlight">\(G_1 \sim \text{SBM}(n, B_1)\)</span> and <span class="math notranslate nohighlight">\(G_2 \sim \text{SBM}(n, B_2)\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">graspologic.simulations</span> <span class="kn">import</span> <span class="n">sbm</span>

<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
<span class="n">B1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]]</span>
<span class="n">B2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
      <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">G1</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
<span class="n">G2</span> <span class="o">=</span> <span class="n">sbm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.8.7/x64/lib/python3.8/site-packages/umap/__init__.py:9: UserWarning: Tensorflow not installed; ParametricUMAP will be unavailable
  warn(&#34;Tensorflow not installed; ParametricUMAP will be unavailable&#34;)
</pre></div></div>
</div>
</div>
<div class="section" id="Visualize-the-graphs-using-heatmap">
<h2>Visualize the graphs using heatmap<a class="headerlink" href="#Visualize-the-graphs-using-heatmap" title="Permalink to this headline">¶</a></h2>
<p>We visualize the sampled graphs using the <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> function. <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> will plot the adjacency matrix, where the colors represent the weight of each edge. In this case, we have binary graphs so the values will be either 0 or 1.</p>
<p>We see that there is clear block structure to the graphs. Furthermore, the lower right quarter of <span class="math notranslate nohighlight">\(G_1\)</span>, representing the within-group connections for the second group, is more dense than that of <span class="math notranslate nohighlight">\(G_2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">heatmap</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Visualization of Graph 1&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">heatmap</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Visualization of Graph 2&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_9_0.png" src="../_images/embedding_MASE_9_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_9_1.png" src="../_images/embedding_MASE_9_1.png" />
</div>
</div>
</div>
<div class="section" id="Embed-the-two-graphs-using-MASE">
<h2>Embed the two graphs using MASE<a class="headerlink" href="#Embed-the-two-graphs-using-MASE" title="Permalink to this headline">¶</a></h2>
<p>Just as ASE fits a single input graph to the Random Dot Product Graph (RDPG) model, MASE fits many input graphs to the common subspace independent-edge (COSIE) model, which is an extension of the RDPG model to multiple graphs. The COSIE model assumes that all of the graphs have important shared properties, but can also have meaningful differences. As a result, COSIE decomposes the set of graphs into a set of shared latent positions <span class="math notranslate nohighlight">\(V\)</span> that describe similarities, and a set of score
matrices <span class="math notranslate nohighlight">\(R^{(i)}\)</span> that describe how each individual graph is different. Mathematically, for the adjacency matrix of an undirected graph <span class="math notranslate nohighlight">\(A^{(i)}\)</span>,</p>
<div class="math notranslate nohighlight">
\[A^{(i)} = VR^{(i)}V^T\]</div>
<p>In general, 2 clusters can be faithfully represented in 2 dimensions, so we specify the number of components as 2. Then, the <code class="docutils literal notranslate"><span class="pre">fit_transform()</span></code> method returns the estimated latent positions <span class="math notranslate nohighlight">\(\hat{V}\)</span>, which we can see has 50 entries corresponding to the 50 vertices embedded in 2 dimensions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">graspologic.embed</span> <span class="kn">import</span> <span class="n">MultipleASE</span> <span class="k">as</span> <span class="n">MASE</span>

<span class="n">embedder</span> <span class="o">=</span> <span class="n">MASE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">V_hat</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">G1</span><span class="p">,</span> <span class="n">G2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V_hat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(50, 2)
</pre></div></div>
</div>
</div>
<div class="section" id="Visualize-Common-Latent-Positions">
<h2>Visualize Common Latent Positions<a class="headerlink" href="#Visualize-Common-Latent-Positions" title="Permalink to this headline">¶</a></h2>
<p>Since the two graphs have clear block structures, with higher within-block probabilities than between-block, we see two distinct “clusters” when we visualize the shared latent positions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">vis_latent</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">predicted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pred_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">predicted</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">V_hat</span><span class="p">[</span><span class="n">pred_labels</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V_hat</span><span class="p">[</span><span class="n">pred_labels</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicted Block 1&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">V_hat</span><span class="p">[</span><span class="n">pred_labels</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V_hat</span><span class="p">[</span><span class="n">pred_labels</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicted Block 2&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Block 1&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">25</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">25</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Block 2&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">vis_latent</span><span class="p">(</span><span class="n">V_hat</span><span class="p">,</span> <span class="s2">&quot;Common Latent Positions from MASE Embedding&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_16_0.png" src="../_images/embedding_MASE_16_0.png" />
</div>
</div>
</div>
<div class="section" id="Recover-Original-Communities">
<h2>Recover Original Communities<a class="headerlink" href="#Recover-Original-Communities" title="Permalink to this headline">¶</a></h2>
<p>We can apply a simple clustering algorithm (kmeans) to recover the original communities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Cluster V_hat</span>
<span class="kn">from</span> <span class="nn">graspologic.cluster</span> <span class="kn">import</span> <span class="n">KMeansCluster</span>
<span class="n">clusterer</span> <span class="o">=</span> <span class="n">KMeansCluster</span><span class="p">()</span>
<span class="n">pred_labels</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">V_hat</span><span class="p">)</span>

<span class="c1">#Remap labels</span>
<span class="kn">from</span> <span class="nn">graspologic.utils</span> <span class="kn">import</span> <span class="n">remap_labels</span>
<span class="n">true_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">25</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">25</span>
<span class="n">remapped_labels</span> <span class="o">=</span> <span class="n">remap_labels</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">pred_labels</span><span class="p">)</span>

<span class="c1">#Visualize latent positions</span>
<span class="n">vis_latent</span><span class="p">(</span><span class="n">V_hat</span><span class="p">,</span> <span class="s2">&quot;Predicted Communities from Common Latent Positions&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">remapped_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_19_0.png" src="../_images/embedding_MASE_19_0.png" />
</div>
</div>
<p>Even with only one graph sampled from each SBM, we can perfectly recover the two communities!</p>
</div>
<div class="section" id="Sampling-More-Graphs">
<h2>Sampling More Graphs<a class="headerlink" href="#Sampling-More-Graphs" title="Permalink to this headline">¶</a></h2>
<p>We can recover a more accurate representation of the two SBM populations with more sample graphs. Let’s try with 100 graphs sampled from each.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">G1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sbm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">G2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sbm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>

<span class="n">V_hat</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">G1</span> <span class="o">+</span> <span class="n">G2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Visualizing-Common-Latent-Subspace">
<h2>Visualizing Common Latent Subspace<a class="headerlink" href="#Visualizing-Common-Latent-Subspace" title="Permalink to this headline">¶</a></h2>
<p>Now, the clustering is even more distinct, as we would expect with more samples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vis_latent</span><span class="p">(</span><span class="n">V_hat</span><span class="p">,</span> <span class="s2">&quot;Common Latent Subspace from MASE Embedding with Many Sampled Graphs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_26_0.png" src="../_images/embedding_MASE_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Visualize-Score-Matrices">
<h2>Visualize Score Matrices<a class="headerlink" href="#Visualize-Score-Matrices" title="Permalink to this headline">¶</a></h2>
<p>Now that we have more samples, we can apply the same process to visualize the individual score matrices. Note, since the score matrices are symmetric, <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrices, we only need a 3-dimensional vector to represent each. In this case, we can clearly see two distinct clusters: one for the score matrices from the first SBM population another for the score matrices from the second.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">pairplot</span>

<span class="c1">#Extract Score Matrices (in vector form)</span>
<span class="n">R_1_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">embedder</span><span class="o">.</span><span class="n">scores_</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">R_2_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">embedder</span><span class="o">.</span><span class="n">scores_</span><span class="p">[</span><span class="mi">100</span><span class="p">:],</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1">#Omitting redundant entries due to symmetry</span>
<span class="n">R_1_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">R_1_hat</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">R_2_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">R_2_hat</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Combining into a single array</span>
<span class="n">R_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">R_1_hat</span><span class="p">,</span> <span class="n">R_2_hat</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#Visualize</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SBM 1&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;SBM 2&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">R_hat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Score Matrices from MASE Embedding&quot;</span><span class="p">,</span>
             <span class="n">palette</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">},</span> <span class="n">legend_name</span><span class="o">=</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_29_0.png" src="../_images/embedding_MASE_29_0.png" />
</div>
</div>
</div>
<div class="section" id="Recover-Original-SBM-Membership">
<h2>Recover Original SBM Membership<a class="headerlink" href="#Recover-Original-SBM-Membership" title="Permalink to this headline">¶</a></h2>
<p>As before, we can apply a simple clustering algorithm (kmeans) to recover from which SBM population each graph was generated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Cluster R_hat</span>
<span class="n">pred_labels</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">R_hat</span><span class="p">)</span>
<span class="n">true_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">remapped_labels</span> <span class="o">=</span> <span class="n">remap_labels</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">pred_labels</span><span class="p">)</span>
<span class="n">pred_sbm</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">remapped_labels</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pred_sbm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SBM 1&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pred_sbm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SBM 2&quot;</span><span class="p">)</span>

<span class="c1">#Visualize Results</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pairplot</span><span class="p">(</span><span class="n">R_hat</span><span class="p">,</span> <span class="n">pred_sbm</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Predicted SBM Membership from Score Matrices&quot;</span><span class="p">,</span>
             <span class="n">palette</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">},</span> <span class="n">legend_name</span><span class="o">=</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/embedding_MASE_32_0.png" src="../_images/embedding_MASE_32_0.png" />
</div>
</div>
<p>With this method we can perfectly recover the original SBM population to which each graph belongs!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../inference/latent_position_test.html" class="btn btn-neutral float-right" title="Latent Position Two-Graph Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Omnibus.html" class="btn btn-neutral float-left" title="Omnibus Embedding for Multiple Graphs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>